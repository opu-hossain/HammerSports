{% extends 'base.html' %}
{% block page_content %}

<div class="title">
    <h2>{{ post.title }}</h2>
</div>

<article>
    <small>
        {{post.created_on.date}} | Categories: 
            {% for category in post.categories.all %}
                <a href="{% url 'Blog_category' category.name %}">{{category.name}}</a>
            {% endfor %}
            {% if post.featured_image %}
                <img src="{{ post.featured_image.url }}" alt="{{ post.title }}">
            {% endif %}
    </small>
    <p>{{post.body | safe }}</p>
    <p>Tags: {% for tag in post.tags.all %}{{ tag.name }}{% if not forloop.last %}, {% endif %}{% endfor %}</p>
</article>


<section>
    <h3>Leave a Comment</h3>
    <form action="" method="post">
        {% csrf_token %}
            <div>{{form.author}}</div>
            <div>{{form.body}}</div>
            <button type="submit" class="btn btn-primary">Submit</button>
    </form>
</section>
<section>
    <h3>Related Posts:</h3>
    {% for related_post in related_posts|slice:":2" %}
        <article>
            <h2><a href="{% url 'Blog_details' slug=related_post.slug %}">{{ related_post.title }}</a></h2>
            {% if related_post.featured_image %}
                <img src="{{ related_post.featured_image.url }}" alt="{{ related_post.title }}">
            {% endif %}
        </article>
    {% empty %}
        <p>No related posts found.</p>
    {% endfor %}
</section>

<section>
    <h3>Comments:</h3>
    {% for comment in comments %}
        <article class="comment">
            <p>On {{ comment.created_on|date:"F j, Y" }} <b>{{ comment.author }}</b> wrote:</p>
            <p>{{ comment.body | linebreaks }}</p>
        </article>
    {% endfor %}
</section>

{% endblock page_content %}